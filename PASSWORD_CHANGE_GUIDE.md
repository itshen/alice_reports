# 修改密码功能使用指南

## 功能概述

系统已成功添加了修改密码功能，支持安全的密码修改操作。

## 主要特性

✅ **安全的密码存储**: 使用 Werkzeug 的密码哈希功能，密码经过加密存储
✅ **用户认证**: 从硬编码认证升级为数据库用户认证
✅ **密码验证**: 修改密码时需要验证当前密码
✅ **前端验证**: 包含密码长度、匹配等前端验证
✅ **用户友好界面**: 美观的修改密码页面

## 使用方法

### 1. 登录系统
- 访问: `http://localhost:8866`
- 使用默认账户: `admin` / `admin123`

### 2. 修改密码
- 登录后，点击导航栏右上角的 🔒 图标
- 输入当前密码
- 输入新密码（至少6位）
- 确认新密码
- 点击"修改密码"按钮

### 3. 密码要求
- 最小长度：6位
- 建议使用字母、数字和符号组合
- 新密码和确认密码必须匹配

## 技术实现

### 后端 (app.py)
- 添加了 `User` 模型导入
- 修改了登录逻辑，使用数据库用户验证
- 添加了 `/change-password` 页面路由
- 添加了 `/api/change-password` API接口
- 在 `create_tables()` 中自动创建默认管理员用户

### 数据库 (models.py)
- 新增 `User` 模型
- 包含密码哈希存储和验证方法
- 支持用户状态管理

### 前端 (templates/)
- 新增 `change_password.html` 页面
- 修改 `dashboard.html` 添加修改密码链接
- 包含完整的前端验证和用户体验

## 安全特性

1. **密码加密**: 使用 `werkzeug.security` 进行密码哈希
2. **会话验证**: 需要登录才能修改密码
3. **当前密码验证**: 修改密码时必须提供当前密码
4. **输入验证**: 前后端双重验证
5. **错误处理**: 完善的错误提示和日志记录

## 注意事项

- 首次启动时会自动创建默认管理员用户 `admin/admin123`
- 建议首次登录后立即修改默认密码
- 密码修改成功后会自动跳转回控制台
- 所有密码操作都会记录在系统日志中

## 故障排除

如果遇到问题，请检查：
1. 数据库是否正确初始化
2. 用户模型是否正确导入
3. 查看系统日志获取详细错误信息

---

**版权信息**: Copyright (c) 2025 Miyang Tech (Zhuhai Hengqin) Co., Ltd.
**许可协议**: MIT License
